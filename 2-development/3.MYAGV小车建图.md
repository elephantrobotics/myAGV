# MYAGV小车建图
# 1.打开slam激光扫描launch文件
打开小车后，打开控制台终端(快捷键<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>T</kbd>)，在命令行中输入以下指令:
```bash
roslaunch navigation_demo myagv_slam.launch 
```
***注意：在开启launch文件之前，请先将小车放置在需要建图环境中的一个合适起始点位上，因为开启launch文件将会开启小车的IMU传感器及odom里程器，人为的移动小车将造成小车建图失真。***

打开小车slam激光扫描所需的launch文件，若显示

> First IMU message received.

则说明小车建图文件打开成功，终端内显示状态如下：

![建图文件成功打开](./image/小车建图/建图终端.png)

同时会打开一个Rviz仿真环境，在Rviz中可以看到红色的小车以及表示当前方向的箭头

![建图Rviz](./image/小车建图/建图rviz.png)
***注意：若Rviz仿真无法打开，可以查看 myagv_slam.launch 文件的倒数2-4行是否被注释，若被注释只需要取消注释即可打开。***

# 2.打开键盘控制文件teleop_twist_keyboard.py

重新打开一个控制台终端，在终端命令行中输入：

```bash
rosrun teleop_twist_keyboard teleop_twist_keyboard.py 
```
![键盘控制终端](./image/小车建图/键盘控制终端.png)
**方向键：**
按键    | 方向
-------- | -----
i  | 前进
，  | 后退
j | 右旋转
l | 左旋转
u|左前进
o|右前进
m|左后退
.|右后退
**加减速：**
按键 |含义
------|-----
q/z|线速度及角速度加/减10%
w/x|线性速度加/减10%
e/c|角速度的加/减速10%

# 3.开始建图
现在小车可以在键盘的控制下开始移动了，操控小车在所需建图的空间内转一圈吧。与此同时，可以看到在Rviz空间里我们的地图也会跟着小车的移动一点点的把地图构建出来了。(建议用键盘‘z’键减小小车的行进速度，有助于建图时获得更精确的地图)
***注意：在用键盘操作小车的时候，确保运行teleop_twist_keyboard.py的终端是当前选中的窗口，否则键盘控制程序无法识别键盘的按键。***
![建图轨迹Rviz](./image/小车建图/建图轨迹rviz.png)

# 4.保存所构建的地图
再打开一个新的控制台终端，在命令行中输入以下指令，用来保存小车扫描完成的地图：
```c
rosrun map_server map_saver 
```
运行成功后终端显示如下：

![地图文件](./image/小车建图/地图文件.png)

这里可以看到我们画了个红圈圈，只是地图保存后生成的两个文件，分别为 map.pgm 和 map.yaml。这两个文件默认会保存在家目录。在同一个终端内输入 **cd** 则会进入我们的家目录，再输入 **ls** 可以看到在家目录下生成的地图文件已经生成好了。

![家目录地图文件](./image/小车建图/家目录地图文件.png)


